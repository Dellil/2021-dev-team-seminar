## 리팩터링의 정의

### 명사형 정의

`소프트웨어의 겉보기 동작을 유지한 채, 코드를 이해하고 수정하기 쉬운 형태로 내부 구조를 변경하는 기법`

### 동사형 정의

`소프트웨어의 겉보기 동작을 유지한 채, 리팩터링 기법을 적용해 소프트웨어를 재구성하다`

ex → 리팩터링을 두 시간 정도 할 것 같은데, 여러 리팩토링 기법을 적용할 것 같다.

**겉보기 동작?** → 리팩토링 전과 후의 코드 동작이 똑같아야 되서 겉보기 동작이라 명함

ex →

- 프론트: 같은 UI를 보여줘야 함, 같은 이벤트일때 같은 행동을 보여줘야 함
- 백: 같은 입력, 같은 출력 (리팩토링 기법으로 입력의 모양은 달라질 순 있겠지만 출력은 같아야됨)

버그가 있었으면 그 버그 마저 있는 대로 동작 (물론 남들이 발견 못한 버그는 고쳐도 괜찮다!)

정리 →

- 리팩터링하다 라는건 한번에 바꿀 수 있는 코드를 수 많은 단계로 나눠 특정 방식으로 코드를 정리해 소프트웨어의 겉보기 동작을 유지하는 것
- 이런 단계들을 순차적으로 연결해 큰 변화를 만드는 것

ex → 저번 주 리팩토링 과정 잘게 **보기**

**저번 주 리팩토링 예제 잘게 나눠 설명하기**

---

## 리팩터링하는 이유

**프로그래밍 속도를 높일 수 있기 때문임**

- 리팩터링을 하는데 시간이 드니 전체 개발 속도는 떨어지는 건 아닐까요?
  - 새로운 기능을 추가 할 수 록 기존 코드 베이스에 녹이는 시간이 상승
    - 기능 추가하다 버그 펑! 터지면 버그 해결하는 시간도 걸림
    - **이 상황이 계속되면 그냥 처음부터 다시 만드는 편이 낫다는 결론에 도달하게 됨**

즉 리팩터링하며 기능 추가하는 시간 <<<<< 기능 추가만 하는 시간 이라는 것

위의 사례를 그래프로 그려보면 이렇게 나옴

**(자료만들 때 그림 채워넣기)**

이걸 설계-지구력 가설(Design Stamina Hypothesis)라 부름

- 내부 설계에 심혈을 기울이면 소프트웨어의 지구력이 높아져 기능을 더 빠르게 추가 할 수 있음

정리 → 리팩터링을 하면 설계를 지속해서 개선할 수 있고, 개선된 설계는 빠른 개발을 할 수 있으므로 리팩터링을 해야됨 즉, 더 적은 노력으로 더 많은 가치를 내기 위해 경제적인 이유로 리팩터링을 한다.

---

## 언제 리팩터링을 할까

- 준비를 위한 리팩터링 → 기능을 쉽게 추가하게 만들기
- 이해를 위한 리팩터링 → 코드를 이해하기 쉽게 만들기
- 쓰레기 줍기 리팩터링 → 나중에 일을 낭비하려 하는 것들 치우기
- 계획된 리팩터링 & 수시로 하는 리팩터링
- 오래 걸리는 리팩터링

### 그러면 언제 안할까?

- 지저분한 코드를 발견해도 수정할 필요가 없는 경우
  - 일회용 코드
  - 외부 API 다루듯 호출하는 경우
- 리팩터링보다 처음 만드는게 더 빠른 경우

정리 → 그냥 코딩할 때마다 리팩터링 하자

---

켄트 벡과 마틴 파울러는 리팩터링이 필요한, 때로는 아주 절실한 코드들에는 일정한 패턴들이 있다는걸 알게됨

## 3.1 기이한 이름 (Mysterious Name)

`추리 소설이라면 무슨 일이 전개되는지 궁금증을 지어낼 수록 좋지만, 코드는 아니다. 세계적인 기인이라는 느낌을 풍기고 싶더라도 꾹 참고 코드는 단순하고 명료하게 작성해야 한다.`

코드를 명료하게 표현하는 데 가장 중요한 요소 하나는 바로 '이름'이다

- 함수 선언 바꾸기 (6.5절, 함수 이름을 바꿀 때도 사용한다.)
- 변수 이름 바꾸기 (6.7절)
- 필드 이름 바꾸기 (9.2절)

마땅한 이름이 떠오르지 않는다면 설계에 더 근본적인 문제가 숨어 있을 가능성이 더 높다. 그래서 혼란스러운 이름만 잘 정리하면 코드가 훨씬 더 간결해질 때가 많다.

## 3.2 중복 코드 (Duplicated Code)

같은 코드 구조가 여러 곳에서 반복된다면 하나로 통합하여 더 나은 프로그램을 만들 수 있다.

코드가 중복되면 각각을 볼 때마다 서로 차이점은 없는지 주의 깊게 살펴봐야 하는 부담이 생긴다. 그래서 그중 하나를 변경할 때, 다른 비슷한 코드들도 모두 살펴보고 적절히 수정해야 한다.

- 함수 추출하기 (6.1절)
- (코드가 비슷하긴 한데, 완전히 같지 않다면) 문장 슬라이드 후 함수 추출하기 (8.6절)
- (같은 부모로부터 파생 된 서브 클래스들에 코드중복) 메서드 올리기 (12.1절)
